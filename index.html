<!DOCTYPE html>
<html>

<head>
    <title>Some interesting title</title>
    <script class="jsbin" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <script class="jsbin" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.0/jquery-ui.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/justadudewhohacks/face-api.js/dist/face-api.min.js"></script>

    <style>
        @font-face {
            font-family: 'Comic Sans';
            src: url('fonts/comic-sans.woff') format('woff')
        }
        
        body,
        html {
            padding: 0;
            margin: 0;
            background-color: #000098;
            color: yellow;
            font-family: 'Comic Sans';
        }
        
        section#description {
            text-align: center;
            display: block;
        }
        
        section#description .description-text {
            position: relative;
            margin: 1%;
        }
        
        section#description .description-text p {
            font-size: 1.5em;
        }
        
        section#upload {
            display: none;
        }
        
        section#result {
            display: none;
        }
        
        img.flip-vertical-axis {
            transform: scaleX(-1);
        }
        
        #content {
            text-align: center;
            position: absolute;
            top: 40%;
            margin-top: -150px;
            width: 100vw;
            font-family: 'Comic Sans';
        }
        
        #img {
            height: 300px;
            width: 300px;
            border: 1px solid black;
            display: inline-block;
        }
        
        marquee {
            font-size: 50px;
            margin-top: 30px;
            font-family: 'Comic Sans';
        }
        
        .star {
            height: 200px;
            width: 200px;
        }
        
        #stars {
            position: absolute;
            display: inline-block;
            bottom: 30px;
            width: 100vw;
            height: 200px;
            padding: 0;
            margin: 0;
            text-align: center;
        }
        
        input {
            font-family: 'Comic Sans';
        }
        
        .button {
            text-decoration: underline;
            cursor: pointer;
            border-color: #cbcbcb #4e474e #4e474e #cbcbcb;
            border-style: solid;
            border-width: 10px;
            color: 000098;
            font-size: 30px;
        }
        
        .button:hover {
            color: yellow;
        }
    </style>
</head>

<body>
    <section id="description">
        <header>
            <div class="info-cringe">
                <img src="https://i.annihil.us/u/prod/marvel/movies/captain-marvel/2/assets/images/about/fireball.gif" class="flip-vertical-axis">
                <img src="https://i.annihil.us/u/prod/marvel/movies/captain-marvel/2/assets/images/about/title.gif">
                <img src="https://i.annihil.us/u/prod/marvel/movies/captain-marvel/2/assets/images/about/fireball.gif">
            </div>
        </header>
        <div class="description-text">
            <p>
                Hi! We are SDSLabs. You might be knowing of us as Software Development Section but lowkey we actually are Sanatan Dharmi Sangh.
            </p>
            <p>
                We are a wannabe start-up that helps you become rich at the comfort of your home. Nope, you don't need to marry a nigerian prince/princess.
            </p>
            <p>
                We crunched the numbers and analyzed the flow of economy to create this revolutionary app.
            </p>
            <p>
                You can upload your photo and we will check if you had a rich ancestor.
            </p>
        </div>
        <button id="makeMeRich" class="button">I want to be rich</button>
    </section>

    <section id="upload">
        <div id="stars"></div>
        <marquee behaviour="alternate" scrollamount=50>BABA JI KI JA HO</marquee>
        <div id="content">
            <img id="img" align="middle" style="color:000098" src="#" onerror="this.src='http://www.stleos.uq.edu.au/wp-content/uploads/2016/08/image-placeholder.png'" /><br><br>
            <input id="up" type="file" accept="image/*" class="button" /><br><br>

            <input type="text" placeholder="Name" /><br><br>
            <button class="button" id="finalise">Take me there</button>
        </div>
    </section>

    <section id="result">

    </section>

    <script>
        let currentPage = 0;
        window.addEventListener("load", () => {
            history.pushState(null, null, 'home')
        })

        function changePage(pagenum) {
            currentPage = pagenum;
            switch (pagenum) {
                case 0:
                    $("section#description").show();
                    $("section#upload").hide();
                    $("section#result").hide();
                    break;
                case 1:
                    $("section#description").hide();
                    $("section#upload").show();
                    $("section#result").hide();
                    break;
                case 2:
                    $("section#description").hide();
                    $("section#upload").hide();
                    $("section#result").show();
                    break;
                default:
                    return false;
            }
        }
        $("#makeMeRich").click(
            () => {
                changePage(1)
                document.getElementsByTagName('marquee')[0].start();
                history.pushState(null, null, 'image')
            }
        )
        $("#finalise").click(
            () => {
                changePage(2);
            }
        )
        window.addEventListener('popstate', () => {
            changePage(currentPage - 1);
        })
        var up = document.getElementById('up');
        up.onchange = function() {
            var image = up.files[0];
            var reader = new FileReader();
            reader.onloadend = function() {
                img = document.getElementById('img');
                img.src = reader.result;
            }
            reader.readAsDataURL(image);

            async function isFace() {
                await faceapi.loadTinyFaceDetectorModel('/models')
                let detection = await faceapi.detectSingleFace(img, new faceapi.TinyFaceDetectorOptions())
                if (detection && detection.score > 0.5) {
                    console.log(detection.score)
                    return true
                } else {
                    console.log("No face detected")
                    return false
                }
            }
            isFace();


        }
        var y = document.getElementById('stars');
        var a = window.innerWidth / 200;
        a = parseInt(a);
        var star = '<img class="star" src="https://thumbs.gfycat.com/GlassWellgroomedIndri.webp">';

        for (i = 0; i < a; i++) {
            y.innerHTML += star;
        }
    </script>
</body>

</html>